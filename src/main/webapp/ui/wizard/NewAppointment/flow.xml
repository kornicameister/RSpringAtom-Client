<?xml version="1.0" encoding="UTF-8"?>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  ~ This file is part of [SpringAtom] Copyright [kornicameister@gmail.com][2013]                  ~
  ~                                                                                               ~
  ~ [SpringAtom] is free software: you can redistribute it and/or modify                          ~
  ~ it under the terms of the GNU General Public License as published by                          ~
  ~ the Free Software Foundation, either version 3 of the License, or                             ~
  ~ (at your option) any later version.                                                           ~
  ~                                                                                               ~
  ~ [SpringAtom] is distributed in the hope that it will be useful,                               ~
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of                                ~
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                 ~
  ~ GNU General Public License for more details.                                                  ~
  ~                                                                                               ~
  ~ You should have received a copy of the GNU General Public License                             ~
  ~ along with [SpringAtom].  If not, see <http://www.gnu.org/licenses/gpl.html>.                 ~
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

<!--suppress XmlPathReference -->
<flow xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      parent="wizard"
      start-state="step1"
      xmlns="http://www.springframework.org/schema/webflow"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow
                          http://www.springframework.org/schema/webflow/spring-webflow.xsd">

    <var name="wizard" class="org.agatom.springatom.webmvc.wizard.SVAppointmentWizard"/>

    <on-start>
        <evaluate expression="wizard.id" result="flowScope.wizardID"/>
        <evaluate expression="'wizard.form.NewAppointment'" result="flowScope.formID"/>
    </on-start>

    <view-state id="step1" view="ui.wizard.NewAppointment.1" model="appointment" popup="true">
        <on-entry>
            <evaluate expression="wizard.appointmentDTO" result="flowScope.appointment"/>
            <evaluate expression="SCarService.findAll" result="viewScope.cars"/>
        </on-entry>
        <transition on="next" to="step2"/>
        <transition on="cancel" to="cancel" history="invalidate"/>
    </view-state>

    <view-state id="step2" view="ui.wizard.NewAppointment.2" popup="true">
        <transition on="previous" to="step1"/>
        <transition on="next" to="step3"/>
        <transition on="cancel" to="cancel" history="invalidate"/>
    </view-state>

    <view-state id="step3" view="ui.wizard.NewAppointment.3" popup="true">
        <transition on="finish" to="success" history="invalidate"/>
        <transition on="cancel" to="cancel" history="invalidate"/>
    </view-state>

    <end-state id="success" commit="true" view="springatom.tiles.dashboard.calendar"/>
    <end-state id="cancel" view="springatom.tiles.dashboard.calendar"/>

</flow>